<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ product.product_name }} - Product Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); }
        .product-image { 
            max-height: 500px; 
            object-fit: contain; 
            transition: transform 0.3s ease;
            animation: fadeInLeft 0.8s ease-out;
        }
        .product-image:hover { transform: scale(1.05); }
        .product-info { 
            background: rgba(255,255,255,0.95); 
            backdrop-filter: blur(10px);
            border-radius: 15px; 
            padding: 2rem; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            animation: fadeInRight 0.8s ease-out;
        }
        .price { 
            font-size: 1.8rem; 
            color: #d32f2f; 
            font-weight: bold;
            animation: bounceIn 1s ease-out 0.3s both;
        }
        .original-price { text-decoration: line-through; color: #6c757d; }
        .action-buttons .btn { 
            padding: 12px 25px; 
            font-size: 1.1rem; 
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .btn-danger:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(211, 47, 47, 0.3); }
        .btn-outline-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(13, 110, 253, 0.2); }
        .rating { color: #ffc107; animation: fadeInUp 0.6s ease-out 0.5s both; }
        .description { white-space: pre-line; }
        .nav-tabs { animation: slideInUp 0.6s ease-out 0.7s both; }
        .tab-content { animation: fadeIn 0.8s ease-out 0.9s both; }
        .product-info > * { animation: fadeInUp 0.6s ease-out both; }
        .product-info > *:nth-child(1) { animation-delay: 0.1s; }
        .product-info > *:nth-child(2) { animation-delay: 0.2s; }
        .product-info > *:nth-child(3) { animation-delay: 0.3s; }
        .product-info > *:nth-child(4) { animation-delay: 0.4s; }
        .img-thumbnail { 
            transition: all 0.3s ease; 
            cursor: pointer;
            animation: zoomIn 0.5s ease-out;
        }
        .img-thumbnail:hover { transform: scale(1.1); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .input-group button { transition: all 0.3s ease; }
        .input-group button:hover { background: #007bff; color: white; }
        .badge { animation: pulse 2s infinite; }
        
        @keyframes fadeInLeft { from { opacity: 0; transform: translateX(-50px); } }
        @keyframes fadeInRight { from { opacity: 0; transform: translateX(50px); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } }
        @keyframes slideInUp { from { opacity: 0; transform: translateY(50px); } }
        @keyframes fadeIn { from { opacity: 0; } }
        @keyframes bounceIn { 
            0% { opacity: 0; transform: scale(0.3); }
            50% { opacity: 1; transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { opacity: 1; transform: scale(1); }
        }
        @keyframes zoomIn { from { opacity: 0; transform: scale(0.5); } }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        
        .btn-ripple { position: relative; overflow: hidden; }
        .ripple { 
            position: absolute; 
            border-radius: 50%; 
            background: rgba(255,255,255,0.6); 
            transform: scale(0); 
            animation: ripple 0.6s linear;
            pointer-events: none;
        }
        @keyframes ripple { to { transform: scale(4); opacity: 0; } }
    </style>
</head>
<body>
    <div class="container py-5">
        <div class="row">
            <!-- Product Images -->
            <div class="col-md-6">
                <div class="mb-4">
                    <img src="/media/{{ product.image }}" alt="{{ product.product_name }}" class="img-fluid product-image rounded-4 shadow" />
                </div>
                <div class="row g-2">
                    <div class="col-3">
                        <img src="/media/{{ product.image }}" alt="Thumbnail 1" class="img-thumbnail rounded-3">
                    </div>
                </div>
            </div>

            <!-- Product Info -->
            <div class="col-md-6">
                <div class="product-info h-100">
                    <h1 class="mb-3 fw-bold">{{ product.product_name }}</h1>

                    <!-- Rating -->
                    <div class="mb-3">
                        <span class="rating">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i>
                            <i class="fas fa-star"></i><i class="fas fa-star"></i>
                            <i class="far fa-star"></i>
                        </span>
                        <span class="ms-2 text-muted">(42 reviews)</span>
                    </div>

                    <!-- Price -->
                    <div class="mb-4">
                        <span class="price">${{ product.price }}</span>
                        {% if product.original_price %}
                            <span class="original-price ms-2">${{ product.original_price }}</span>
                            <span class="badge bg-danger ms-2">Save {{ product.discount_percentage }}%</span>
                        {% endif %}
                    </div>

                    <!-- Short Description -->
                    <div class="mb-4">
                        <p class="lead text-muted">{{ product.short_description }}</p>
                    </div>

                    <!-- Variants -->
                    <div class="mb-4">
                        <label class="form-label fw-semibold">Color:</label>
                        <div class="btn-group" role="group">
                            <input type="radio" class="btn-check" name="color" id="color1" autocomplete="off" checked>
                            <label class="btn btn-outline-secondary" for="color1">Black</label>
                            <input type="radio" class="btn-check" name="color" id="color2" autocomplete="off">
                            <label class="btn btn-outline-secondary" for="color2">White</label>
                            <input type="radio" class="btn-check" name="color" id="color3" autocomplete="off">
                            <label class="btn btn-outline-secondary" for="color3">Blue</label>
                        </div>
                    </div>

                    <!-- Quantity -->
                    <form id="cart-form" method="POST" action="{% url 'add_to_cart' product.id %}">
                        {% csrf_token %}
                        <div class="mb-4">
                            <label for="quantity" class="form-label fw-semibold">Quantity:</label>
                            <div class="input-group" style="width: 150px;">
                                <button class="btn btn-outline-secondary" type="button" id="decrement">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <input type="number" class="form-control text-center fw-bold" value="1" min="1" id="quantity" name="quantity">
                                <button class="btn btn-outline-secondary" type="button" id="increment">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </form>

                    <!-- Action Buttons -->
                    <div class="action-buttons d-grid gap-3">
                        <!-- Buy Now Button -->
                        <form id="buy-form" method="POST" action="{% url 'buy_view' product.id %}">
                            {% csrf_token %}
                            <input type="hidden" name="quantity" id="buy_quantity" value="1">
                            <button type="submit" class="btn btn-danger btn-lg btn-ripple rounded-pill w-100">
                                <i class="fas fa-bolt me-2"></i>Buy Now
                            </button>
                        </form>

                        <!-- Add to Cart Button -->
                        <button type="submit" form="cart-form" class="btn btn-outline-primary btn-lg btn-ripple rounded-pill w-100">
                            <i class="fas fa-cart-plus me-2"></i>Add to Cart
                        </button>
                    </div>

                    <!-- Additional Info -->
                    <div class="mt-4 pt-3 border-top">
                        <div class="d-flex mb-2">
                            <div style="width: 120px;" class="fw-semibold text-primary">
                                <i class="fas fa-check-circle me-1"></i>Availability:
                            </div>
                            <div class="text-success fw-bold">In Stock ({{ product.stock_quantity }} items)</div>
                        </div>
                        <div class="d-flex mb-2">
                            <div style="width: 120px;" class="fw-semibold text-primary">
                                <i class="fas fa-tag me-1"></i>Brand:
                            </div>
                            <div>{{ product.brand|default:"Generic" }}</div>
                        </div>
                        <div class="d-flex">
                            <div style="width: 120px;" class="fw-semibold text-primary">
                                <i class="fas fa-barcode me-1"></i>SKU:
                            </div>
                            <div>{{ product.sku|default:"N/A" }}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="row mt-5">
            <div class="col-12">
                <ul class="nav nav-tabs" id="productTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active fw-semibold" id="description-tab" data-bs-toggle="tab" data-bs-target="#description" type="button" role="tab">
                            <i class="fas fa-info-circle me-2"></i>Description
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link fw-semibold" id="specs-tab" data-bs-toggle="tab" data-bs-target="#specs" type="button" role="tab">
                            <i class="fas fa-cogs me-2"></i>Specifications
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link fw-semibold" id="reviews-tab" data-bs-toggle="tab" data-bs-target="#reviews" type="button" role="tab">
                            <i class="fas fa-star me-2"></i>Reviews
                        </button>
                    </li>
                </ul>
                <div class="tab-content p-4 border border-top-0 rounded-bottom bg-white shadow-sm" id="productTabsContent">
                    <div class="tab-pane fade show active" id="description" role="tabpanel">
                        <h4 class="mb-3 text-primary">
                            <i class="fas fa-clipboard-list me-2"></i>Product Details
                        </h4>
                        <div class="description">
                            {{ product.desc|default:"No description available." }}
                        </div>
                    </div>
                    <div class="tab-pane fade" id="specs" role="tabpanel">
                        <h4 class="mb-3 text-primary">
                            <i class="fas fa-wrench me-2"></i>Technical Specifications
                        </h4>
                        <table class="table table-hover">
                            <tbody>
                                {% if product.specifications %}
                                    {% for spec in product.specifications %}
                                        <tr>
                                            <th style="width: 30%;" class="text-primary">{{ spec.name }}</th>
                                            <td>{{ spec.value }}</td>
                                        </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr><td colspan="2" class="text-center text-muted">No specifications available.</td></tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                    <div class="tab-pane fade" id="reviews" role="tabpanel">
                        <h4 class="mb-3 text-primary">
                            <i class="fas fa-comments me-2"></i>Customer Reviews
                        </h4>
                        <div class="alert alert-info border-0 rounded-3">
                            <i class="fas fa-info-circle me-2"></i>
                            No reviews yet. Be the first to review this product!
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const quantityInput = document.getElementById('quantity');
        const buyQuantityInput = document.getElementById('buy_quantity');

        document.getElementById('increment').addEventListener('click', function () {
            quantityInput.value = parseInt(quantityInput.value) + 1;
            buyQuantityInput.value = quantityInput.value;
            // Add bounce effect
            this.style.transform = 'scale(0.95)';
            setTimeout(() => this.style.transform = 'scale(1)', 150);
        });

        document.getElementById('decrement').addEventListener('click', function () {
            if (parseInt(quantityInput.value) > 1) {
                quantityInput.value = parseInt(quantityInput.value) - 1;
                buyQuantityInput.value = quantityInput.value;
                // Add bounce effect
                this.style.transform = 'scale(0.95)';
                setTimeout(() => this.style.transform = 'scale(1)', 150);
            }
        });

        // Sync quantity input manually if changed
        quantityInput.addEventListener('input', function () {
            buyQuantityInput.value = quantityInput.value;
        });

        // Add ripple effect to buttons
        document.querySelectorAll('.btn-ripple').forEach(button => {
            button.addEventListener('click', function(e) {
                let ripple = document.createElement('span');
                let rect = this.getBoundingClientRect();
                let size = Math.max(rect.width, rect.height);
                let x = e.clientX - rect.left - size / 2;
                let y = e.clientY - rect.top - size / 2;
                
                ripple.classList.add('ripple');
                ripple.style.width = ripple.style.height = size + 'px';
                ripple.style.left = x + 'px';
                ripple.style.top = y + 'px';
                
                this.appendChild(ripple);
                
                setTimeout(() => {
                    ripple.remove();
                }, 600);
            });
        });

        // Add subtle animation to thumbnails on load
        setTimeout(() => {
            document.querySelectorAll('.img-thumbnail').forEach((thumb, index) => {
                thumb.style.animationDelay = (index * 0.1) + 's';
            });
        }, 100);

        // Add smooth tab transitions
        document.querySelectorAll('[data-bs-toggle="tab"]').forEach(tab => {
            tab.addEventListener('shown.bs.tab', function (e) {
                const targetPane = document.querySelector(e.target.getAttribute('data-bs-target'));
                targetPane.style.opacity = '0';
                targetPane.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    targetPane.style.transition = 'all 0.3s ease';
                    targetPane.style.opacity = '1';
                    targetPane.style.transform = 'translateY(0)';
                }, 10);
            });
        });
    </script>
</body>
</html>